Ordered version on 'ordered' branch.
